---
title: "Domain transfer on  Shot records"
author:
  - name: Yadhu Kartha
    email: yadhukartha@gatech.edu
    url: https://mloubout.github.io
    affiliations:
      - ref: gatech
  - name: Felix J. Herrmann
    orcid: "0000-0003-1180-2167"
    affiliations:
      - ref: gatech
affiliations:
  - id: gatech
    name: Georgia Institute of Technology
    url: https://slim.gatech.edu/
description: | 
  Domain transfer using Condtional normalizing flows on Shot records.
bibliography: paper.bib
abstract: |
  code reproducible at [here](https://github.com/YadhuKartha686/Domain_transfer/blob/main/scripts/DTwithCNF.jl)
---

::: hidden
$$
    \newcommand{\pluseq}{\mathrel{+}=}
$$
:::

## Motivation

The primary objective is to develop a mapping from acoustic shot records without density information to those with density information. There is a pressing need for a computationally efficient approach to generate shot records with density information from those lacking it, in order to achieve stronger reflections and a clearer image of the subsurface. This method promises to offer an accurate and cost-effective way to produce acoustic shot records with density information, which are typically expensive to create

## Method

This methodology employs machine learning techniques to establish a bidirectional mapping between two domains: acoustic shot records with and without density. This approach allows for a detailed analysis and comparison between these two states. We utilize a conditional normalizing flow as the generator for this purpose, enabling a sophisticated and precise modeling of the relationship between the domains.  

Data for the training phase were generated by selecting slices from the BGCompass model and positioning sources and receivers at the top. The chosen source frequency was 25 Hz. Specifically, the shot record produced by the central source was selected for the dataset. Three sources and receivers were placed along the top of the model at each pixel interval. To enhance clarity and realism in the shot records, I employed nonlinear modeling.

In the training phase, we employ an alternating methodology with GANs to meticulously train both the discriminator and the generator. This method involves first training the discriminator to distinguish between real and generated data, followed by training the generator to create data that the discriminator cannot easily classify as generated. A key innovation in our approach is the adoption of a Conditional Normalizing Flow network as the generator. This choice is motivated by its computational efficiency and the significant advantage of invertibility, which conventional GANs lack. Unlike traditional GANs that require separate networks for each direction of data transfer, a single conditional normalizing flow network suffices for bidirectional transfer. The networks are trained using adversarial loss[@Dreher_2023], with the generator undergoing validation at each epoch. The input to the network comprises shot records and their conditions, represented as arrays of zeros and ones, effectively labeling the domains. During generation, a shot record is passed through the network along with its domain indication, prompting the network to transfer it to the alternate domain. This method supersedes previous approaches that necessitated two different GAN networks for bidirectional domain mapping, thereby enhancing memory efficiency with the use of a single conditional normalizing flow network.

::: {#fig-vdtov }
![](figures/trainingreg.png)

This is a schematic diagram of the training regime. The blue arrows indicate forward pass through the conditional normalizing flow (G) and the green arrows indicate the inverse or generation pass. Here X represent the shot record image, Y represent the condition, that is the domain the shot record belongs which are domain 1 and domain 2 and Z represents the latent space. Domain 1 and Domain 2 are arrays of integers 1 and 0 in the same shape as the input image. As you can notice here, the forward pass latent space is used for domain transfer, essentially transferring the input image to the other domain.
:::


## Results

We apply the proposed domain transfer approach to a previously unseen shot record. Results for the learned network on these test shot record are presented in Figures 1 and 2, respectively. For reference, the original shot data are included on the left, followed by the domain transferred shot record on the right. Figure 1 shows that the domain transferred shot record has dimmer events in the body and the waves are sligtly thinner as expected of a velocity only shot record. Figure 2 shows that the domain transferred shot record has brighter and sharper events compared to the test shot record, which is expected from the shot record which consists of velocity and density


::: {#fig-vdtov }
![](figures/comparetestveldenandvel.png)

Test shot record data vs domain transferred shot record. Left columnn consists of test shot record consisting of velocity and density and right column consists of domain transferred shot record of this test shot record to only velocity domain.
:::

::: {#fig-vtovd }
![](figures/comparetestvelandvelden.png)

Test shot record data vs domain transferred shot record. Left columnn consists of test shot record consisting of velocity and right column consists of domain transferred shot record of this test shot record to velocity and density domain.
:::

::: {#fig-test }
![](figures/testdatacomp.png)

Test shot record of one domain vs test shot record of second domain. Left column represents test shot record of velcity only shot record and right column consists of velocity and density shot record.
::: 


## Significance


The adoption of Conditional Normalizing Flow networks marks a strategic advancement towards enhanced computational efficiency and shorter processing times. This innovation significantly eases the management of large datasets, paving the way for more cost-effective exploration activities by reducing the reliance on expensive field measurements. Additionally, it democratizes access to advanced subsurface exploration tools, broadening the scope of geophysical research.

This method showcases its versatility by facilitating a bidirectional mapping between two domains that share a common property but differ significantly in accessibilityâ€”one may be expensive or difficult to acquire, while the other is readily available. A prime example of its application is the mapping between acoustic and elastic shot records. Elastic shot records, typically costly to produce, can now be efficiently generated from acoustic shot records. This not only saves resources but also opens up new avenues for research and exploration in domains previously limited by resource constraints.


## Discussion and conclusions

We introduced a Domain transfer method that generates highly accurate samples with minimal computational costs. By training a conditional normalizing flow, we have effectively learned the mapping between two domains of interest, ensuring that the generated data accurately reflect the characteristics of each domain. Our findings demonstrate that the images produced are consistent with the intrinsic properties of their respective domains. Furthermore, we have shown that the computational costs associated with training and inference are significantly lower than those of previous approaches. This efficiency is largely due to our innovative use of a single network for bidirectional mapping, a strategy that simplifies the process and reduces resource requirements compared to traditional methods involving separate networks for each direction of data transfer.[@10.1190/geo2022-0247.1]

### References

::: {#refs}
:::

## Acknowledgement {.appendix}

This research was carried out with the support of Georgia Research Alliance and partners of the ML4Seismic Center.

